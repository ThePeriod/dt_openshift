apiVersion: v1
items:
- apiVersion: build.openshift.io/v1
  kind: Build
  metadata:
    annotations:
      openshift.io/jenkins-blueocean-log-url: /http://jenkins-cicd.api-cloud.dirtrab.cl/blue/organizations/jenkins/pipelines-prod%2Fpipelines-prod-csr0001-validacionesfondosmall/detail/pipelines-prod-csr0001-validacionesfondosmall/10/
      openshift.io/jenkins-build-uri: http://jenkins-cicd.api-cloud.dirtrab.cl/job/pipelines-prod/job/pipelines-prod-csr0001-validacionesfondosmall/10/
      openshift.io/jenkins-console-log-url: http://jenkins-cicd.api-cloud.dirtrab.cl/job/pipelines-prod/job/pipelines-prod-csr0001-validacionesfondosmall/10/console
      openshift.io/jenkins-log-url: http://jenkins-cicd.api-cloud.dirtrab.cl/job/pipelines-prod/job/pipelines-prod-csr0001-validacionesfondosmall/10/consoleText
      openshift.io/jenkins-status-json: '{"_links":{"self":{"href":"http://jenkins-cicd.api-cloud.dirtrab.cl/job/pipelines-prod/job/pipelines-prod-csr0001-validacionesfondosmall/10/wfapi/describe"}},"id":"10","name":"#10","status":"FAILED","startTimeMillis":1697468843805,"endTimeMillis":1697468864304,"durationMillis":20499,"queueDurationMillis":5,"pauseDurationMillis":0,"stages":[{"_links":{"self":{"href":"http://jenkins-cicd.api-cloud.dirtrab.cl/job/pipelines-prod/job/pipelines-prod-csr0001-validacionesfondosmall/10/execution/node/6/wfapi/describe"}},"id":"6","name":"Clonando
        repo y Compilando","execNode":"","status":"FAILED","error":{"message":"Error
        cloning remote repo ''origin''","type":"hudson.AbortException"},"startTimeMillis":1697468854290,"durationMillis":9583,"pauseDurationMillis":0}]}'
    creationTimestamp: "2023-10-16T15:07:23Z"
    generation: 1
    labels:
      app: cicd-pipeline
      buildconfig: csr0001-validacionesfondosmall
      group: cicd
      migration.openshift.io/migrated-by-migmigration: 7765386f-b389-4f43-9a59-edf571957ed6
      migration.openshift.io/migrated-by-migplan: cc640fb7-e663-45df-b691-0008663d0ae9
      name: cicd-pipeline
      openshift.io/build-config.name: csr0001-validacionesfondosmall
      openshift.io/build.start-policy: Serial
      template: cicd
      velero.io/backup-name: migration-15bf4-initial-6wqzl
      velero.io/restore-name: migration-15bf4-final-5jpwz
    name: csr0001-validacionesfondosmall-1
    namespace: pipelines-prod
    ownerReferences:
    - apiVersion: build.openshift.io/v1
      controller: true
      kind: BuildConfig
      name: csr0001-validacionesfondosmall
      uid: 531fce7c-bc23-453a-aef0-382412762a05
    resourceVersion: "136379192"
    uid: 97d4ce64-5f21-4cbf-89c3-90ad899a6fb1
  spec:
    nodeSelector: {}
    output: {}
    postCommit: {}
    resources: {}
    serviceAccount: builder
    source:
      type: None
    strategy:
      jenkinsPipelineStrategy:
        env:
        - name: PROD_PROJECT
          value: api-fiscalizacion-prod
        - name: ENABLE_QUAY
          value: "false"
        jenkinsfile: |
          pipeline {
            agent {
              label 'maven'
            }
            stages {
              stage('Clonando repo y Compilando') {
                  steps {
                      git([url: 'https://dirtrab.visualstudio.com/Libro%20Remuneraciones%20Electronico/_git/CSR0001-ValidacionesFondo-v2',
                      branch: 'master',
                      credentialsId: 'azure_credenciales_id'])
                  script {
                      def pom = readMavenPom file: 'pom.xml'
                      version = pom.version
                  }
                  sh "mvn -s configuration/settings.xml install -DskipTests=true"
                }
              }
              stage('Creando Image Builder') {
                when {
                  expression {
                    openshift.withCluster() {
                      openshift.withProject(env.PROD_PROJECT) {
                        return !openshift.selector("bc", "csr0001-validacionesfondosmall").exists();
                      }
                    }
                  }
                }
                steps {
                  script {
                    openshift.withCluster() {
                      openshift.withProject(env.PROD_PROJECT) {
                        openshift.newBuild("--name=csr0001-validacionesfondosmall", "--image-stream=redhat-openjdk18-openshift:1.4", "--binary=true")
                      }
                    }
                  }
                }
              }
              stage('Construyendo imagen') {
                steps {
                  sh "rm -rf oc-build && mkdir -p oc-build/deployments"
                  sh "cp target/CSR0001-ValidacionesFondo-v2-1.0.0.jar oc-build/deployments/CSR0001-ValidacionesFondo-v2.jar"

                  script {
                    openshift.withCluster() {
                      openshift.withProject(env.PROD_PROJECT) {
                        openshift.selector("bc", "csr0001-validacionesfondosmall").startBuild("--from-dir=oc-build", "--wait=true")
                      }
                    }
                  }
                  sh "sleep 10"
                }
              }
              stage('Creando en prod') {
                when {
                  expression {
                    openshift.withCluster() {
                      openshift.withProject(env.PROD_PROJECT) {
                        return !openshift.selector('dc', 'csr0001-validacionesfondosmall').exists()
                      }
                    }
                  }
                }
                steps {
                  script {
                    openshift.withCluster() {
                      openshift.withProject(env.PROD_PROJECT) {
                        def app = openshift.newApp("csr0001-validacionesfondosmall:latest")
                        app.narrow("svc").expose();
                        def dc = openshift.selector("dc", "csr0001-validacionesfondosmall")
                        while (dc.object().spec.replicas != dc.object().status.availableReplicas) {
                            sleep 10
                        }
                        openshift.set("triggers", "dc/csr0001-validacionesfondosmall", "--manual")
                      }
                      sh "sleep 40"
                    }
                  }
                }
              }
              stage('Desplegando en prod') {
                steps {
                sh "sleep 45"
                  script {
                    openshift.withCluster() {
                      openshift.withProject(env.PROD_PROJECT) {
                        openshift.selector("dc", "csr0001-validacionesfondosmall").rollout().latest();
                      }
                      sh "sleep 15"
                    }
                  }
                }
              }
            }
          }
      type: JenkinsPipeline
    triggeredBy:
    - message: Triggered by Jenkins job at http://jenkins-cicd.api-cloud.dirtrab.cl/job/pipelines-prod/job/pipelines-prod-csr0001-validacionesfondosmall/
  status:
    completionTimestamp: "2023-10-16T15:07:44Z"
    conditions:
    - lastTransitionTime: "2023-10-16T15:07:23Z"
      lastUpdateTime: "2023-10-16T15:07:23Z"
      status: "False"
      type: New
    - lastTransitionTime: "2023-10-16T15:07:24Z"
      lastUpdateTime: "2023-10-16T15:07:24Z"
      status: "False"
      type: Pending
    - lastTransitionTime: "2023-10-16T15:07:44Z"
      lastUpdateTime: "2023-10-16T15:07:44Z"
      status: "False"
      type: Running
    - lastTransitionTime: "2023-10-16T15:07:44Z"
      lastUpdateTime: "2023-10-16T15:07:44Z"
      status: "True"
      type: Failed
    config:
      kind: BuildConfig
      name: csr0001-validacionesfondosmall
      namespace: pipelines-prod
    output: {}
    phase: Failed
    startTimestamp: "2023-10-16T15:07:23Z"
- apiVersion: build.openshift.io/v1
  kind: Build
  metadata:
    annotations:
      openshift.io/jenkins-blueocean-log-url: /http://jenkins-cicd.api-cloud.dirtrab.cl/blue/organizations/jenkins/pipelines-prod%2Fpipelines-prod-csr0001-validacionesfondosmall/detail/pipelines-prod-csr0001-validacionesfondosmall/11/
      openshift.io/jenkins-build-uri: http://jenkins-cicd.api-cloud.dirtrab.cl/job/pipelines-prod/job/pipelines-prod-csr0001-validacionesfondosmall/11/
      openshift.io/jenkins-console-log-url: http://jenkins-cicd.api-cloud.dirtrab.cl/job/pipelines-prod/job/pipelines-prod-csr0001-validacionesfondosmall/11/console
      openshift.io/jenkins-log-url: http://jenkins-cicd.api-cloud.dirtrab.cl/job/pipelines-prod/job/pipelines-prod-csr0001-validacionesfondosmall/11/consoleText
      openshift.io/jenkins-status-json: '{"_links":{"self":{"href":"http://jenkins-cicd.api-cloud.dirtrab.cl/job/pipelines-prod/job/pipelines-prod-csr0001-validacionesfondosmall/11/wfapi/describe"}},"id":"11","name":"#11","status":"SUCCESS","startTimeMillis":1697468901860,"endTimeMillis":1697469380576,"durationMillis":478716,"queueDurationMillis":6,"pauseDurationMillis":0,"stages":[{"_links":{"self":{"href":"http://jenkins-cicd.api-cloud.dirtrab.cl/job/pipelines-prod/job/pipelines-prod-csr0001-validacionesfondosmall/11/execution/node/6/wfapi/describe"}},"id":"6","name":"Clonando
        repo y Compilando","execNode":"","status":"SUCCESS","startTimeMillis":1697468913487,"durationMillis":335071,"pauseDurationMillis":0},{"_links":{"self":{"href":"http://jenkins-cicd.api-cloud.dirtrab.cl/job/pipelines-prod/job/pipelines-prod-csr0001-validacionesfondosmall/11/execution/node/28/wfapi/describe"}},"id":"28","name":"Construyendo
        imagen","execNode":"","status":"SUCCESS","startTimeMillis":1697469251526,"durationMillis":65095,"pauseDurationMillis":0},{"_links":{"self":{"href":"http://jenkins-cicd.api-cloud.dirtrab.cl/job/pipelines-prod/job/pipelines-prod-csr0001-validacionesfondosmall/11/execution/node/51/wfapi/describe"}},"id":"51","name":"Desplegando
        en prod","execNode":"","status":"SUCCESS","startTimeMillis":1697469317146,"durationMillis":63369,"pauseDurationMillis":0}]}'
    creationTimestamp: "2023-10-16T15:08:21Z"
    generation: 1
    labels:
      app: cicd-pipeline
      buildconfig: csr0001-validacionesfondosmall
      group: cicd
      migration.openshift.io/migrated-by-migmigration: 7765386f-b389-4f43-9a59-edf571957ed6
      migration.openshift.io/migrated-by-migplan: cc640fb7-e663-45df-b691-0008663d0ae9
      name: cicd-pipeline
      openshift.io/build-config.name: csr0001-validacionesfondosmall
      openshift.io/build.start-policy: Serial
      template: cicd
      velero.io/backup-name: migration-15bf4-initial-6wqzl
      velero.io/restore-name: migration-15bf4-final-5jpwz
    name: csr0001-validacionesfondosmall-2
    namespace: pipelines-prod
    ownerReferences:
    - apiVersion: build.openshift.io/v1
      controller: true
      kind: BuildConfig
      name: csr0001-validacionesfondosmall
      uid: 531fce7c-bc23-453a-aef0-382412762a05
    resourceVersion: "136384238"
    uid: 9cb29e00-e6c3-4d90-ae3b-771f47259e31
  spec:
    nodeSelector: {}
    output: {}
    postCommit: {}
    resources: {}
    serviceAccount: builder
    source:
      type: None
    strategy:
      jenkinsPipelineStrategy:
        env:
        - name: PROD_PROJECT
          value: api-fiscalizacion-prod
        - name: ENABLE_QUAY
          value: "false"
        jenkinsfile: |
          pipeline {
            agent {
              label 'maven'
            }
            stages {
              stage('Clonando repo y Compilando') {
                  steps {
                      git([url: 'https://dirtrab.visualstudio.com/Libro%20Remuneraciones%20Electronico/_git/CSR0001-ValidacionesFondo-v2',
                      branch: 'master',
                      credentialsId: 'vsts'])
                  script {
                      def pom = readMavenPom file: 'pom.xml'
                      version = pom.version
                  }
                  sh "mvn -s configuration/settings.xml install -DskipTests=true"
                }
              }
              stage('Creando Image Builder') {
                when {
                  expression {
                    openshift.withCluster() {
                      openshift.withProject(env.PROD_PROJECT) {
                        return !openshift.selector("bc", "csr0001-validacionesfondosmall").exists();
                      }
                    }
                  }
                }
                steps {
                  script {
                    openshift.withCluster() {
                      openshift.withProject(env.PROD_PROJECT) {
                        openshift.newBuild("--name=csr0001-validacionesfondosmall", "--image-stream=redhat-openjdk18-openshift:1.4", "--binary=true")
                      }
                    }
                  }
                }
              }
              stage('Construyendo imagen') {
                steps {
                  sh "rm -rf oc-build && mkdir -p oc-build/deployments"
                  sh "cp target/CSR0001-ValidacionesFondo-v2-1.0.0.jar oc-build/deployments/CSR0001-ValidacionesFondo-v2.jar"

                  script {
                    openshift.withCluster() {
                      openshift.withProject(env.PROD_PROJECT) {
                        openshift.selector("bc", "csr0001-validacionesfondosmall").startBuild("--from-dir=oc-build", "--wait=true")
                      }
                    }
                  }
                  sh "sleep 10"
                }
              }
              stage('Creando en prod') {
                when {
                  expression {
                    openshift.withCluster() {
                      openshift.withProject(env.PROD_PROJECT) {
                        return !openshift.selector('dc', 'csr0001-validacionesfondosmall').exists()
                      }
                    }
                  }
                }
                steps {
                  script {
                    openshift.withCluster() {
                      openshift.withProject(env.PROD_PROJECT) {
                        def app = openshift.newApp("csr0001-validacionesfondosmall:latest")
                        app.narrow("svc").expose();
                        def dc = openshift.selector("dc", "csr0001-validacionesfondosmall")
                        while (dc.object().spec.replicas != dc.object().status.availableReplicas) {
                            sleep 10
                        }
                        openshift.set("triggers", "dc/csr0001-validacionesfondosmall", "--manual")
                      }
                      sh "sleep 40"
                    }
                  }
                }
              }
              stage('Desplegando en prod') {
                steps {
                sh "sleep 45"
                  script {
                    openshift.withCluster() {
                      openshift.withProject(env.PROD_PROJECT) {
                        openshift.selector("dc", "csr0001-validacionesfondosmall").rollout().latest();
                      }
                      sh "sleep 15"
                    }
                  }
                }
              }
            }
          }
      type: JenkinsPipeline
    triggeredBy:
    - message: Triggered by Jenkins job at http://jenkins-cicd.api-cloud.dirtrab.cl/job/pipelines-prod/job/pipelines-prod-csr0001-validacionesfondosmall/
  status:
    completionTimestamp: "2023-10-16T15:16:20Z"
    conditions:
    - lastTransitionTime: "2023-10-16T15:08:21Z"
      lastUpdateTime: "2023-10-16T15:08:21Z"
      status: "False"
      type: New
    - lastTransitionTime: "2023-10-16T15:08:24Z"
      lastUpdateTime: "2023-10-16T15:08:24Z"
      status: "False"
      type: Pending
    - lastTransitionTime: "2023-10-16T15:16:20Z"
      lastUpdateTime: "2023-10-16T15:16:20Z"
      status: "False"
      type: Running
    - lastTransitionTime: "2023-10-16T15:16:20Z"
      lastUpdateTime: "2023-10-16T15:16:20Z"
      status: "True"
      type: Complete
    config:
      kind: BuildConfig
      name: csr0001-validacionesfondosmall
      namespace: pipelines-prod
    output: {}
    phase: Complete
    startTimestamp: "2023-10-16T15:08:21Z"
- apiVersion: build.openshift.io/v1
  kind: Build
  metadata:
    annotations:
      openshift.io/jenkins-blueocean-log-url: /http://jenkins-cicd.api-cloud.dirtrab.cl/blue/organizations/jenkins/pipelines-prod%2Fpipelines-prod-prox0001-registralibrorem/detail/pipelines-prod-prox0001-registralibrorem/20/
      openshift.io/jenkins-build-uri: http://jenkins-cicd.api-cloud.dirtrab.cl/job/pipelines-prod/job/pipelines-prod-prox0001-registralibrorem/20/
      openshift.io/jenkins-console-log-url: http://jenkins-cicd.api-cloud.dirtrab.cl/job/pipelines-prod/job/pipelines-prod-prox0001-registralibrorem/20/console
      openshift.io/jenkins-log-url: http://jenkins-cicd.api-cloud.dirtrab.cl/job/pipelines-prod/job/pipelines-prod-prox0001-registralibrorem/20/consoleText
      openshift.io/jenkins-status-json: '{"_links":{"self":{"href":"http://jenkins-cicd.api-cloud.dirtrab.cl/job/pipelines-prod/job/pipelines-prod-prox0001-registralibrorem/20/wfapi/describe"}},"id":"20","name":"#20","status":"FAILED","startTimeMillis":1697468332357,"endTimeMillis":1697468489482,"durationMillis":157125,"queueDurationMillis":4,"pauseDurationMillis":0,"stages":[{"_links":{"self":{"href":"http://jenkins-cicd.api-cloud.dirtrab.cl/job/pipelines-prod/job/pipelines-prod-prox0001-registralibrorem/20/execution/node/6/wfapi/describe"}},"id":"6","name":"Clonando
        repo y Compilando","execNode":"","status":"FAILED","error":{"message":"script
        returned exit code 1","type":"hudson.AbortException"},"startTimeMillis":1697468340690,"durationMillis":148312,"pauseDurationMillis":0}]}'
    creationTimestamp: "2023-10-16T14:58:52Z"
    generation: 1
    labels:
      app: cicd-pipeline
      buildconfig: prox0001-registralibrorem
      group: cicd
      migration.openshift.io/migrated-by-migmigration: 7765386f-b389-4f43-9a59-edf571957ed6
      migration.openshift.io/migrated-by-migplan: cc640fb7-e663-45df-b691-0008663d0ae9
      name: cicd-pipeline
      openshift.io/build-config.name: prox0001-registralibrorem
      openshift.io/build.start-policy: Serial
      template: cicd
      velero.io/backup-name: migration-15bf4-initial-6wqzl
      velero.io/restore-name: migration-15bf4-final-5jpwz
    name: prox0001-registralibrorem-1
    namespace: pipelines-prod
    ownerReferences:
    - apiVersion: build.openshift.io/v1
      controller: true
      kind: BuildConfig
      name: prox0001-registralibrorem
      uid: a939c29d-58b9-4fc7-b002-ca77daa6c6d1
    resourceVersion: "136375427"
    uid: 05ad660a-8187-436b-932e-754f3dc9b729
  spec:
    nodeSelector: {}
    output: {}
    postCommit: {}
    resources: {}
    serviceAccount: builder
    source:
      type: None
    strategy:
      jenkinsPipelineStrategy:
        env:
        - name: PROD_PROJECT
          value: api-fiscalizacion-prod
        - name: ENABLE_QUAY
          value: "false"
        jenkinsfile: |
          pipeline {
            agent {
              label 'maven'
            }
            stages {
              stage('Clonando repo y Compilando') {
                  steps {
                      git([url: 'https://dirtrab.visualstudio.com/Libro%20Remuneraciones%20Electronico/_git/PRX0001-RegistraLibroRemumeracion',
                      branch: 'master',
                      credentialsId: 'vsts'])
                  script {
                      def pom = readMavenPom file: 'pom.xml'
                      version = pom.version
                  }
                  sh "mvn -s configuration/settings.xml install -DskipTests=true"
                }
              }
              stage('Creando Image Builder') {
                when {
                  expression {
                    openshift.withCluster() {
                      openshift.withProject(env.PROD_PROJECT) {
                        return !openshift.selector("bc", "prox0001-registralibrore").exists();
                      }
                    }
                  }
                }
                steps {
                  script {
                    openshift.withCluster() {
                      openshift.withProject(env.PROD_PROJECT) {
                        openshift.newBuild("--name=prox0001-registralibrore", "--image-stream=fuse7-java-openshift:1.3", "--binary=true")
                      }
                    }
                  }
                }
              }
              stage('Construyendo imagen') {
                steps {
                  sh "rm -rf oc-build && mkdir -p oc-build/deployments"
                  sh "cp target/PRX0001-RegistraLibroRemumeracion-1.0.jar oc-build/deployments/PRX0001-RegistraLibroRemumeracion.jar"

                  script {
                    openshift.withCluster() {
                      openshift.withProject(env.PROD_PROJECT) {
                        openshift.selector("bc", "prox0001-registralibrore").startBuild("--from-dir=oc-build", "--wait=true")
                      }
                    }
                  }
                  sh "sleep 10"
                }
              }
              stage('Creando en Prod') {
                when {
                  expression {
                    openshift.withCluster() {
                      openshift.withProject(env.PROD_PROJECT) {
                        return !openshift.selector('dc', 'prox0001-registralibrore').exists()
                      }
                    }
                  }
                }
                steps {
                  script {
                    openshift.withCluster() {
                      openshift.withProject(env.PROD_PROJECT) {
                        def app = openshift.newApp("prox0001-registralibrore:latest")
                        app.narrow("svc").expose();
                        def dc = openshift.selector("dc", "prox0001-registralibrore")
                        while (dc.object().spec.replicas != dc.object().status.availableReplicas) {
                            sleep 10
                        }
                        openshift.set("triggers", "dc/prox0001-registralibrore", "--manual")
                      }
                      sh "sleep 40"
                    }
                  }
                }
              }
              stage('Desplegando en Prod') {
                steps {
                  script {
                    openshift.withCluster() {
                      openshift.withProject(env.PROD_PROJECT) {
                        openshift.selector("dc", "prox0001-registralibrore").rollout().latest();
                      }
                      sh "sleep 10"
                    }
                  }
                }
              }
            }
          }
      type: JenkinsPipeline
    triggeredBy:
    - message: Triggered by Jenkins job at http://jenkins-cicd.api-cloud.dirtrab.cl/job/pipelines-prod/job/pipelines-prod-prox0001-registralibrorem/
  status:
    completionTimestamp: "2023-10-16T15:01:29Z"
    conditions:
    - lastTransitionTime: "2023-10-16T14:58:52Z"
      lastUpdateTime: "2023-10-16T14:58:52Z"
      status: "False"
      type: New
    - lastTransitionTime: "2023-10-16T14:58:54Z"
      lastUpdateTime: "2023-10-16T14:58:54Z"
      status: "False"
      type: Pending
    - lastTransitionTime: "2023-10-16T15:01:29Z"
      lastUpdateTime: "2023-10-16T15:01:29Z"
      status: "False"
      type: Running
    - lastTransitionTime: "2023-10-16T15:01:29Z"
      lastUpdateTime: "2023-10-16T15:01:29Z"
      status: "True"
      type: Failed
    config:
      kind: BuildConfig
      name: prox0001-registralibrorem
      namespace: pipelines-prod
    output: {}
    phase: Failed
    startTimestamp: "2023-10-16T14:58:52Z"
- apiVersion: build.openshift.io/v1
  kind: Build
  metadata:
    annotations:
      openshift.io/jenkins-blueocean-log-url: /http://jenkins-cicd.api-cloud.dirtrab.cl/blue/organizations/jenkins/pipelines-prod%2Fpipelines-prod-prox0001-registralibrorem/detail/pipelines-prod-prox0001-registralibrorem/23/
      openshift.io/jenkins-build-uri: http://jenkins-cicd.api-cloud.dirtrab.cl/job/pipelines-prod/job/pipelines-prod-prox0001-registralibrorem/23/
      openshift.io/jenkins-console-log-url: http://jenkins-cicd.api-cloud.dirtrab.cl/job/pipelines-prod/job/pipelines-prod-prox0001-registralibrorem/23/console
      openshift.io/jenkins-log-url: http://jenkins-cicd.api-cloud.dirtrab.cl/job/pipelines-prod/job/pipelines-prod-prox0001-registralibrorem/23/consoleText
      openshift.io/jenkins-status-json: '{"_links":{"self":{"href":"http://jenkins-cicd.api-cloud.dirtrab.cl/job/pipelines-prod/job/pipelines-prod-prox0001-registralibrorem/23/wfapi/describe"},"changesets":{"href":"/job/pipelines-prod/job/pipelines-prod-prox0001-registralibrorem/23/wfapi/changesets"}},"id":"23","name":"#23","status":"SUCCESS","startTimeMillis":1697716431191,"endTimeMillis":1697716708068,"durationMillis":276877,"queueDurationMillis":7,"pauseDurationMillis":0,"stages":[{"_links":{"self":{"href":"http://jenkins-cicd.api-cloud.dirtrab.cl/job/pipelines-prod/job/pipelines-prod-prox0001-registralibrorem/23/execution/node/6/wfapi/describe"}},"id":"6","name":"Clonando
        repo y Compilando","execNode":"","status":"SUCCESS","startTimeMillis":1697716441033,"durationMillis":200019,"pauseDurationMillis":0},{"_links":{"self":{"href":"http://jenkins-cicd.api-cloud.dirtrab.cl/job/pipelines-prod/job/pipelines-prod-prox0001-registralibrorem/23/execution/node/28/wfapi/describe"}},"id":"28","name":"Construyendo
        imagen","execNode":"","status":"SUCCESS","startTimeMillis":1697716643077,"durationMillis":53747,"pauseDurationMillis":0},{"_links":{"self":{"href":"http://jenkins-cicd.api-cloud.dirtrab.cl/job/pipelines-prod/job/pipelines-prod-prox0001-registralibrorem/23/execution/node/51/wfapi/describe"}},"id":"51","name":"Desplegando
        en Prod","execNode":"","status":"SUCCESS","startTimeMillis":1697716697240,"durationMillis":10754,"pauseDurationMillis":0}]}'
    creationTimestamp: "2023-10-19T11:53:51Z"
    generation: 1
    labels:
      app: cicd-pipeline
      buildconfig: prox0001-registralibrorem
      group: cicd
      migration.openshift.io/migrated-by-migmigration: 7765386f-b389-4f43-9a59-edf571957ed6
      migration.openshift.io/migrated-by-migplan: cc640fb7-e663-45df-b691-0008663d0ae9
      name: cicd-pipeline
      openshift.io/build-config.name: prox0001-registralibrorem
      openshift.io/build.start-policy: Serial
      template: cicd
      velero.io/backup-name: migration-15bf4-initial-6wqzl
      velero.io/restore-name: migration-15bf4-final-5jpwz
    name: prox0001-registralibrorem-4
    namespace: pipelines-prod
    ownerReferences:
    - apiVersion: build.openshift.io/v1
      controller: true
      kind: BuildConfig
      name: prox0001-registralibrorem
      uid: a939c29d-58b9-4fc7-b002-ca77daa6c6d1
    resourceVersion: "138797756"
    uid: 14e0fb04-24df-4534-8bf5-1ab94b303b61
  spec:
    nodeSelector: {}
    output: {}
    postCommit: {}
    resources: {}
    serviceAccount: builder
    source:
      type: None
    strategy:
      jenkinsPipelineStrategy:
        env:
        - name: PROD_PROJECT
          value: api-fiscalizacion-prod
        - name: ENABLE_QUAY
          value: "false"
        jenkinsfile: |
          pipeline {
            agent {
              label 'maven'
            }
            stages {
              stage('Clonando repo y Compilando') {
                  steps {
                      git([url: 'https://dirtrab.visualstudio.com/Libro%20Remuneraciones%20Electronico/_git/PRX0001-RegistraLibroRemumeracion',
                      branch: 'feature/update_ws1_sii_20231016',
                      credentialsId: 'vsts'])
                  script {
                      def pom = readMavenPom file: 'pom.xml'
                      version = pom.version
                  }
                  sh "mvn -s configuration/settings.xml install -DskipTests=true"
                }
              }
              stage('Creando Image Builder') {
                when {
                  expression {
                    openshift.withCluster() {
                      openshift.withProject(env.PROD_PROJECT) {
                        return !openshift.selector("bc", "prox0001-registralibrore").exists();
                      }
                    }
                  }
                }
                steps {
                  script {
                    openshift.withCluster() {
                      openshift.withProject(env.PROD_PROJECT) {
                        openshift.newBuild("--name=prox0001-registralibrore", "--image-stream=fuse7-java-openshift:1.3", "--binary=true")
                      }
                    }
                  }
                }
              }
              stage('Construyendo imagen') {
                steps {
                  sh "rm -rf oc-build && mkdir -p oc-build/deployments"
                  sh "cp target/PRX0001-RegistraLibroRemumeracion-1.0.jar oc-build/deployments/PRX0001-RegistraLibroRemumeracion.jar"

                  script {
                    openshift.withCluster() {
                      openshift.withProject(env.PROD_PROJECT) {
                        openshift.selector("bc", "prox0001-registralibrore").startBuild("--from-dir=oc-build", "--wait=true")
                      }
                    }
                  }
                  sh "sleep 10"
                }
              }
              stage('Creando en Prod') {
                when {
                  expression {
                    openshift.withCluster() {
                      openshift.withProject(env.PROD_PROJECT) {
                        return !openshift.selector('dc', 'prox0001-registralibrore').exists()
                      }
                    }
                  }
                }
                steps {
                  script {
                    openshift.withCluster() {
                      openshift.withProject(env.PROD_PROJECT) {
                        def app = openshift.newApp("prox0001-registralibrore:latest")
                        app.narrow("svc").expose();
                        def dc = openshift.selector("dc", "prox0001-registralibrore")
                        while (dc.object().spec.replicas != dc.object().status.availableReplicas) {
                            sleep 10
                        }
                        openshift.set("triggers", "dc/prox0001-registralibrore", "--manual")
                      }
                      sh "sleep 40"
                    }
                  }
                }
              }
              stage('Desplegando en Prod') {
                steps {
                  script {
                    openshift.withCluster() {
                      openshift.withProject(env.PROD_PROJECT) {
                        openshift.selector("dc", "prox0001-registralibrore").rollout().latest();
                      }
                      sh "sleep 10"
                    }
                  }
                }
              }
            }
          }
      type: JenkinsPipeline
    triggeredBy:
    - message: Triggered by Jenkins job at http://jenkins-cicd.api-cloud.dirtrab.cl/job/pipelines-prod/job/pipelines-prod-prox0001-registralibrorem/
  status:
    completionTimestamp: "2023-10-19T11:58:28Z"
    conditions:
    - lastTransitionTime: "2023-10-19T11:53:51Z"
      lastUpdateTime: "2023-10-19T11:53:51Z"
      status: "False"
      type: New
    - lastTransitionTime: "2023-10-19T11:53:54Z"
      lastUpdateTime: "2023-10-19T11:53:54Z"
      status: "False"
      type: Pending
    - lastTransitionTime: "2023-10-19T11:58:28Z"
      lastUpdateTime: "2023-10-19T11:58:28Z"
      status: "False"
      type: Running
    - lastTransitionTime: "2023-10-19T11:58:28Z"
      lastUpdateTime: "2023-10-19T11:58:28Z"
      status: "True"
      type: Complete
    config:
      kind: BuildConfig
      name: prox0001-registralibrorem
      namespace: pipelines-prod
    output: {}
    phase: Complete
    startTimestamp: "2023-10-19T11:53:51Z"
- apiVersion: build.openshift.io/v1
  kind: Build
  metadata:
    annotations:
      openshift.io/jenkins-blueocean-log-url: /http://jenkins-cicd.api-cloud.dirtrab.cl/blue/organizations/jenkins/pipelines-prod%2Fpipelines-prod-prox0001-registralibrorem/detail/pipelines-prod-prox0001-registralibrorem/24/
      openshift.io/jenkins-build-uri: http://jenkins-cicd.api-cloud.dirtrab.cl/job/pipelines-prod/job/pipelines-prod-prox0001-registralibrorem/24/
      openshift.io/jenkins-console-log-url: http://jenkins-cicd.api-cloud.dirtrab.cl/job/pipelines-prod/job/pipelines-prod-prox0001-registralibrorem/24/console
      openshift.io/jenkins-log-url: http://jenkins-cicd.api-cloud.dirtrab.cl/job/pipelines-prod/job/pipelines-prod-prox0001-registralibrorem/24/consoleText
      openshift.io/jenkins-status-json: '{"_links":{"self":{"href":"http://jenkins-cicd.api-cloud.dirtrab.cl/job/pipelines-prod/job/pipelines-prod-prox0001-registralibrorem/24/wfapi/describe"},"changesets":{"href":"/job/pipelines-prod/job/pipelines-prod-prox0001-registralibrorem/24/wfapi/changesets"}},"id":"24","name":"#24","status":"SUCCESS","startTimeMillis":1698153863149,"endTimeMillis":1698154144966,"durationMillis":281817,"queueDurationMillis":13,"pauseDurationMillis":0,"stages":[{"_links":{"self":{"href":"http://jenkins-cicd.api-cloud.dirtrab.cl/job/pipelines-prod/job/pipelines-prod-prox0001-registralibrorem/24/execution/node/6/wfapi/describe"}},"id":"6","name":"Clonando
        repo y Compilando","execNode":"","status":"SUCCESS","startTimeMillis":1698153871554,"durationMillis":205386,"pauseDurationMillis":0},{"_links":{"self":{"href":"http://jenkins-cicd.api-cloud.dirtrab.cl/job/pipelines-prod/job/pipelines-prod-prox0001-registralibrorem/24/execution/node/28/wfapi/describe"}},"id":"28","name":"Construyendo
        imagen","execNode":"","status":"SUCCESS","startTimeMillis":1698154078997,"durationMillis":54621,"pauseDurationMillis":0},{"_links":{"self":{"href":"http://jenkins-cicd.api-cloud.dirtrab.cl/job/pipelines-prod/job/pipelines-prod-prox0001-registralibrorem/24/execution/node/51/wfapi/describe"}},"id":"51","name":"Desplegando
        en Prod","execNode":"","status":"SUCCESS","startTimeMillis":1698154134056,"durationMillis":10843,"pauseDurationMillis":0}]}'
    creationTimestamp: "2023-10-24T13:24:23Z"
    generation: 1
    labels:
      app: cicd-pipeline
      buildconfig: prox0001-registralibrorem
      group: cicd
      migration.openshift.io/migrated-by-migmigration: 7765386f-b389-4f43-9a59-edf571957ed6
      migration.openshift.io/migrated-by-migplan: cc640fb7-e663-45df-b691-0008663d0ae9
      name: cicd-pipeline
      openshift.io/build-config.name: prox0001-registralibrorem
      openshift.io/build.start-policy: Serial
      template: cicd
      velero.io/backup-name: migration-15bf4-initial-6wqzl
      velero.io/restore-name: migration-15bf4-final-5jpwz
    name: prox0001-registralibrorem-5
    namespace: pipelines-prod
    ownerReferences:
    - apiVersion: build.openshift.io/v1
      controller: true
      kind: BuildConfig
      name: prox0001-registralibrorem
      uid: a939c29d-58b9-4fc7-b002-ca77daa6c6d1
    resourceVersion: "143068290"
    uid: bf62a4eb-0a04-4570-ad45-00bcd41ded0b
  spec:
    nodeSelector: {}
    output: {}
    postCommit: {}
    resources: {}
    serviceAccount: builder
    source:
      type: None
    strategy:
      jenkinsPipelineStrategy:
        env:
        - name: PROD_PROJECT
          value: api-fiscalizacion-prod
        - name: ENABLE_QUAY
          value: "false"
        jenkinsfile: |
          pipeline {
            agent {
              label 'maven'
            }
            stages {
              stage('Clonando repo y Compilando') {
                  steps {
                      git([url: 'https://dirtrab.visualstudio.com/Libro%20Remuneraciones%20Electronico/_git/PRX0001-RegistraLibroRemumeracion',
                      branch: 'feature/update_ws1_sii_20231016',
                      credentialsId: 'vsts'])
                  script {
                      def pom = readMavenPom file: 'pom.xml'
                      version = pom.version
                  }
                  sh "mvn -s configuration/settings.xml install -DskipTests=true"
                }
              }
              stage('Creando Image Builder') {
                when {
                  expression {
                    openshift.withCluster() {
                      openshift.withProject(env.PROD_PROJECT) {
                        return !openshift.selector("bc", "prox0001-registralibrore").exists();
                      }
                    }
                  }
                }
                steps {
                  script {
                    openshift.withCluster() {
                      openshift.withProject(env.PROD_PROJECT) {
                        openshift.newBuild("--name=prox0001-registralibrore", "--image-stream=fuse7-java-openshift:1.3", "--binary=true")
                      }
                    }
                  }
                }
              }
              stage('Construyendo imagen') {
                steps {
                  sh "rm -rf oc-build && mkdir -p oc-build/deployments"
                  sh "cp target/PRX0001-RegistraLibroRemumeracion-1.0.jar oc-build/deployments/PRX0001-RegistraLibroRemumeracion.jar"

                  script {
                    openshift.withCluster() {
                      openshift.withProject(env.PROD_PROJECT) {
                        openshift.selector("bc", "prox0001-registralibrore").startBuild("--from-dir=oc-build", "--wait=true")
                      }
                    }
                  }
                  sh "sleep 10"
                }
              }
              stage('Creando en Prod') {
                when {
                  expression {
                    openshift.withCluster() {
                      openshift.withProject(env.PROD_PROJECT) {
                        return !openshift.selector('dc', 'prox0001-registralibrore').exists()
                      }
                    }
                  }
                }
                steps {
                  script {
                    openshift.withCluster() {
                      openshift.withProject(env.PROD_PROJECT) {
                        def app = openshift.newApp("prox0001-registralibrore:latest")
                        app.narrow("svc").expose();
                        def dc = openshift.selector("dc", "prox0001-registralibrore")
                        while (dc.object().spec.replicas != dc.object().status.availableReplicas) {
                            sleep 10
                        }
                        openshift.set("triggers", "dc/prox0001-registralibrore", "--manual")
                      }
                      sh "sleep 40"
                    }
                  }
                }
              }
              stage('Desplegando en Prod') {
                steps {
                  script {
                    openshift.withCluster() {
                      openshift.withProject(env.PROD_PROJECT) {
                        openshift.selector("dc", "prox0001-registralibrore").rollout().latest();
                      }
                      sh "sleep 10"
                    }
                  }
                }
              }
            }
          }
      type: JenkinsPipeline
    triggeredBy:
    - message: Triggered by Jenkins job at http://jenkins-cicd.api-cloud.dirtrab.cl/job/pipelines-prod/job/pipelines-prod-prox0001-registralibrorem/
  status:
    completionTimestamp: "2023-10-24T13:29:04Z"
    conditions:
    - lastTransitionTime: "2023-10-24T13:24:23Z"
      lastUpdateTime: "2023-10-24T13:24:23Z"
      status: "False"
      type: New
    - lastTransitionTime: "2023-10-24T13:24:24Z"
      lastUpdateTime: "2023-10-24T13:24:24Z"
      status: "False"
      type: Pending
    - lastTransitionTime: "2023-10-24T13:29:04Z"
      lastUpdateTime: "2023-10-24T13:29:04Z"
      status: "False"
      type: Running
    - lastTransitionTime: "2023-10-24T13:29:04Z"
      lastUpdateTime: "2023-10-24T13:29:04Z"
      status: "True"
      type: Complete
    config:
      kind: BuildConfig
      name: prox0001-registralibrorem
      namespace: pipelines-prod
    output: {}
    phase: Complete
    startTimestamp: "2023-10-24T13:24:23Z"
- apiVersion: build.openshift.io/v1
  kind: Build
  metadata:
    annotations:
      openshift.io/jenkins-blueocean-log-url: /http://jenkins-cicd.api-cloud.dirtrab.cl/blue/organizations/jenkins/pipelines-prod%2Fpipelines-prod-prox0001-registralibrorem/detail/pipelines-prod-prox0001-registralibrorem/25/
      openshift.io/jenkins-build-uri: http://jenkins-cicd.api-cloud.dirtrab.cl/job/pipelines-prod/job/pipelines-prod-prox0001-registralibrorem/25/
      openshift.io/jenkins-console-log-url: http://jenkins-cicd.api-cloud.dirtrab.cl/job/pipelines-prod/job/pipelines-prod-prox0001-registralibrorem/25/console
      openshift.io/jenkins-log-url: http://jenkins-cicd.api-cloud.dirtrab.cl/job/pipelines-prod/job/pipelines-prod-prox0001-registralibrorem/25/consoleText
      openshift.io/jenkins-status-json: '{"_links":{"self":{"href":"http://jenkins-cicd.api-cloud.dirtrab.cl/job/pipelines-prod/job/pipelines-prod-prox0001-registralibrorem/25/wfapi/describe"}},"id":"25","name":"#25","status":"FAILED","startTimeMillis":1698155006573,"endTimeMillis":1698155158391,"durationMillis":151818,"queueDurationMillis":13,"pauseDurationMillis":0,"stages":[{"_links":{"self":{"href":"http://jenkins-cicd.api-cloud.dirtrab.cl/job/pipelines-prod/job/pipelines-prod-prox0001-registralibrorem/25/execution/node/6/wfapi/describe"}},"id":"6","name":"Clonando
        repo y Compilando","execNode":"","status":"FAILED","error":{"message":"script
        returned exit code 1","type":"hudson.AbortException"},"startTimeMillis":1698155020900,"durationMillis":137025,"pauseDurationMillis":0}]}'
    creationTimestamp: "2023-10-24T13:43:26Z"
    generation: 1
    labels:
      app: cicd-pipeline
      buildconfig: prox0001-registralibrorem
      group: cicd
      migration.openshift.io/migrated-by-migmigration: 7765386f-b389-4f43-9a59-edf571957ed6
      migration.openshift.io/migrated-by-migplan: cc640fb7-e663-45df-b691-0008663d0ae9
      name: cicd-pipeline
      openshift.io/build-config.name: prox0001-registralibrorem
      openshift.io/build.start-policy: Serial
      template: cicd
      velero.io/backup-name: migration-15bf4-initial-6wqzl
      velero.io/restore-name: migration-15bf4-final-5jpwz
    name: prox0001-registralibrorem-6
    namespace: pipelines-prod
    ownerReferences:
    - apiVersion: build.openshift.io/v1
      controller: true
      kind: BuildConfig
      name: prox0001-registralibrorem
      uid: a939c29d-58b9-4fc7-b002-ca77daa6c6d1
    resourceVersion: "143078283"
    uid: be6dd8be-4217-4d64-bb06-0e9270610a03
  spec:
    nodeSelector: {}
    output: {}
    postCommit: {}
    resources: {}
    serviceAccount: builder
    source:
      type: None
    strategy:
      jenkinsPipelineStrategy:
        env:
        - name: PROD_PROJECT
          value: api-fiscalizacion-prod
        - name: ENABLE_QUAY
          value: "false"
        jenkinsfile: |
          pipeline {
            agent {
              label 'maven'
            }
            stages {
              stage('Clonando repo y Compilando') {
                  steps {
                      git([url: 'https://dirtrab.visualstudio.com/Libro%20Remuneraciones%20Electronico/_git/PRX0001-RegistraLibroRemumeracion',
                      branch: 'feature/prueba_logs',
                      credentialsId: 'vsts'])
                  script {
                      def pom = readMavenPom file: 'pom.xml'
                      version = pom.version
                  }
                  sh "mvn -s configuration/settings.xml install -DskipTests=true"
                }
              }
              stage('Creando Image Builder') {
                when {
                  expression {
                    openshift.withCluster() {
                      openshift.withProject(env.PROD_PROJECT) {
                        return !openshift.selector("bc", "prox0001-registralibrore").exists();
                      }
                    }
                  }
                }
                steps {
                  script {
                    openshift.withCluster() {
                      openshift.withProject(env.PROD_PROJECT) {
                        openshift.newBuild("--name=prox0001-registralibrore", "--image-stream=fuse7-java-openshift:1.3", "--binary=true")
                      }
                    }
                  }
                }
              }
              stage('Construyendo imagen') {
                steps {
                  sh "rm -rf oc-build && mkdir -p oc-build/deployments"
                  sh "cp target/PRX0001-RegistraLibroRemumeracion-1.0.jar oc-build/deployments/PRX0001-RegistraLibroRemumeracion.jar"

                  script {
                    openshift.withCluster() {
                      openshift.withProject(env.PROD_PROJECT) {
                        openshift.selector("bc", "prox0001-registralibrore").startBuild("--from-dir=oc-build", "--wait=true")
                      }
                    }
                  }
                  sh "sleep 10"
                }
              }
              stage('Creando en Prod') {
                when {
                  expression {
                    openshift.withCluster() {
                      openshift.withProject(env.PROD_PROJECT) {
                        return !openshift.selector('dc', 'prox0001-registralibrore').exists()
                      }
                    }
                  }
                }
                steps {
                  script {
                    openshift.withCluster() {
                      openshift.withProject(env.PROD_PROJECT) {
                        def app = openshift.newApp("prox0001-registralibrore:latest")
                        app.narrow("svc").expose();
                        def dc = openshift.selector("dc", "prox0001-registralibrore")
                        while (dc.object().spec.replicas != dc.object().status.availableReplicas) {
                            sleep 10
                        }
                        openshift.set("triggers", "dc/prox0001-registralibrore", "--manual")
                      }
                      sh "sleep 40"
                    }
                  }
                }
              }
              stage('Desplegando en Prod') {
                steps {
                  script {
                    openshift.withCluster() {
                      openshift.withProject(env.PROD_PROJECT) {
                        openshift.selector("dc", "prox0001-registralibrore").rollout().latest();
                      }
                      sh "sleep 10"
                    }
                  }
                }
              }
            }
          }
      type: JenkinsPipeline
    triggeredBy:
    - message: Triggered by Jenkins job at http://jenkins-cicd.api-cloud.dirtrab.cl/job/pipelines-prod/job/pipelines-prod-prox0001-registralibrorem/
  status:
    completionTimestamp: "2023-10-24T13:45:58Z"
    conditions:
    - lastTransitionTime: "2023-10-24T13:43:26Z"
      lastUpdateTime: "2023-10-24T13:43:26Z"
      status: "False"
      type: New
    - lastTransitionTime: "2023-10-24T13:43:29Z"
      lastUpdateTime: "2023-10-24T13:43:29Z"
      status: "False"
      type: Pending
    - lastTransitionTime: "2023-10-24T13:45:58Z"
      lastUpdateTime: "2023-10-24T13:45:58Z"
      status: "False"
      type: Running
    - lastTransitionTime: "2023-10-24T13:45:58Z"
      lastUpdateTime: "2023-10-24T13:45:58Z"
      status: "True"
      type: Failed
    config:
      kind: BuildConfig
      name: prox0001-registralibrorem
      namespace: pipelines-prod
    output: {}
    phase: Failed
    startTimestamp: "2023-10-24T13:43:26Z"
- apiVersion: build.openshift.io/v1
  kind: Build
  metadata:
    annotations:
      openshift.io/jenkins-blueocean-log-url: /http://jenkins-cicd.api-cloud.dirtrab.cl/blue/organizations/jenkins/pipelines-prod%2Fpipelines-prod-prox0001-registralibrorem/detail/pipelines-prod-prox0001-registralibrorem/26/
      openshift.io/jenkins-build-uri: http://jenkins-cicd.api-cloud.dirtrab.cl/job/pipelines-prod/job/pipelines-prod-prox0001-registralibrorem/26/
      openshift.io/jenkins-console-log-url: http://jenkins-cicd.api-cloud.dirtrab.cl/job/pipelines-prod/job/pipelines-prod-prox0001-registralibrorem/26/console
      openshift.io/jenkins-log-url: http://jenkins-cicd.api-cloud.dirtrab.cl/job/pipelines-prod/job/pipelines-prod-prox0001-registralibrorem/26/consoleText
      openshift.io/jenkins-status-json: '{"_links":{"self":{"href":"http://jenkins-cicd.api-cloud.dirtrab.cl/job/pipelines-prod/job/pipelines-prod-prox0001-registralibrorem/26/wfapi/describe"},"changesets":{"href":"/job/pipelines-prod/job/pipelines-prod-prox0001-registralibrorem/26/wfapi/changesets"}},"id":"26","name":"#26","status":"SUCCESS","startTimeMillis":1698155516475,"endTimeMillis":1698155796004,"durationMillis":279529,"queueDurationMillis":10,"pauseDurationMillis":0,"stages":[{"_links":{"self":{"href":"http://jenkins-cicd.api-cloud.dirtrab.cl/job/pipelines-prod/job/pipelines-prod-prox0001-registralibrorem/26/execution/node/6/wfapi/describe"}},"id":"6","name":"Clonando
        repo y Compilando","execNode":"","status":"SUCCESS","startTimeMillis":1698155531804,"durationMillis":197157,"pauseDurationMillis":0},{"_links":{"self":{"href":"http://jenkins-cicd.api-cloud.dirtrab.cl/job/pipelines-prod/job/pipelines-prod-prox0001-registralibrorem/26/execution/node/28/wfapi/describe"}},"id":"28","name":"Construyendo
        imagen","execNode":"","status":"SUCCESS","startTimeMillis":1698155730745,"durationMillis":54017,"pauseDurationMillis":0},{"_links":{"self":{"href":"http://jenkins-cicd.api-cloud.dirtrab.cl/job/pipelines-prod/job/pipelines-prod-prox0001-registralibrorem/26/execution/node/51/wfapi/describe"}},"id":"51","name":"Desplegando
        en Prod","execNode":"","status":"SUCCESS","startTimeMillis":1698155785155,"durationMillis":10781,"pauseDurationMillis":0}]}'
    creationTimestamp: "2023-10-24T13:51:56Z"
    generation: 1
    labels:
      app: cicd-pipeline
      buildconfig: prox0001-registralibrorem
      group: cicd
      migration.openshift.io/migrated-by-migmigration: 7765386f-b389-4f43-9a59-edf571957ed6
      migration.openshift.io/migrated-by-migplan: cc640fb7-e663-45df-b691-0008663d0ae9
      name: cicd-pipeline
      openshift.io/build-config.name: prox0001-registralibrorem
      openshift.io/build.start-policy: Serial
      template: cicd
      velero.io/backup-name: migration-15bf4-initial-6wqzl
      velero.io/restore-name: migration-15bf4-final-5jpwz
    name: prox0001-registralibrorem-7
    namespace: pipelines-prod
    ownerReferences:
    - apiVersion: build.openshift.io/v1
      controller: true
      kind: BuildConfig
      name: prox0001-registralibrorem
      uid: a939c29d-58b9-4fc7-b002-ca77daa6c6d1
    resourceVersion: "143084469"
    uid: 622d3354-fe9b-42cc-a71d-3eae954980b4
  spec:
    nodeSelector: {}
    output: {}
    postCommit: {}
    resources: {}
    serviceAccount: builder
    source:
      type: None
    strategy:
      jenkinsPipelineStrategy:
        env:
        - name: PROD_PROJECT
          value: api-fiscalizacion-prod
        - name: ENABLE_QUAY
          value: "false"
        jenkinsfile: |
          pipeline {
            agent {
              label 'maven'
            }
            stages {
              stage('Clonando repo y Compilando') {
                  steps {
                      git([url: 'https://dirtrab.visualstudio.com/Libro%20Remuneraciones%20Electronico/_git/PRX0001-RegistraLibroRemumeracion',
                      branch: 'feature/prueba_logs',
                      credentialsId: 'vsts'])
                  script {
                      def pom = readMavenPom file: 'pom.xml'
                      version = pom.version
                  }
                  sh "mvn -s configuration/settings.xml install -DskipTests=true"
                }
              }
              stage('Creando Image Builder') {
                when {
                  expression {
                    openshift.withCluster() {
                      openshift.withProject(env.PROD_PROJECT) {
                        return !openshift.selector("bc", "prox0001-registralibrore").exists();
                      }
                    }
                  }
                }
                steps {
                  script {
                    openshift.withCluster() {
                      openshift.withProject(env.PROD_PROJECT) {
                        openshift.newBuild("--name=prox0001-registralibrore", "--image-stream=fuse7-java-openshift:1.3", "--binary=true")
                      }
                    }
                  }
                }
              }
              stage('Construyendo imagen') {
                steps {
                  sh "rm -rf oc-build && mkdir -p oc-build/deployments"
                  sh "cp target/PRX0001-RegistraLibroRemumeracion-1.0.jar oc-build/deployments/PRX0001-RegistraLibroRemumeracion.jar"

                  script {
                    openshift.withCluster() {
                      openshift.withProject(env.PROD_PROJECT) {
                        openshift.selector("bc", "prox0001-registralibrore").startBuild("--from-dir=oc-build", "--wait=true")
                      }
                    }
                  }
                  sh "sleep 10"
                }
              }
              stage('Creando en Prod') {
                when {
                  expression {
                    openshift.withCluster() {
                      openshift.withProject(env.PROD_PROJECT) {
                        return !openshift.selector('dc', 'prox0001-registralibrore').exists()
                      }
                    }
                  }
                }
                steps {
                  script {
                    openshift.withCluster() {
                      openshift.withProject(env.PROD_PROJECT) {
                        def app = openshift.newApp("prox0001-registralibrore:latest")
                        app.narrow("svc").expose();
                        def dc = openshift.selector("dc", "prox0001-registralibrore")
                        while (dc.object().spec.replicas != dc.object().status.availableReplicas) {
                            sleep 10
                        }
                        openshift.set("triggers", "dc/prox0001-registralibrore", "--manual")
                      }
                      sh "sleep 40"
                    }
                  }
                }
              }
              stage('Desplegando en Prod') {
                steps {
                  script {
                    openshift.withCluster() {
                      openshift.withProject(env.PROD_PROJECT) {
                        openshift.selector("dc", "prox0001-registralibrore").rollout().latest();
                      }
                      sh "sleep 10"
                    }
                  }
                }
              }
            }
          }
      type: JenkinsPipeline
    triggeredBy:
    - message: Triggered by Jenkins job at http://jenkins-cicd.api-cloud.dirtrab.cl/job/pipelines-prod/job/pipelines-prod-prox0001-registralibrorem/
  status:
    completionTimestamp: "2023-10-24T13:56:36Z"
    conditions:
    - lastTransitionTime: "2023-10-24T13:51:56Z"
      lastUpdateTime: "2023-10-24T13:51:56Z"
      status: "False"
      type: New
    - lastTransitionTime: "2023-10-24T13:51:59Z"
      lastUpdateTime: "2023-10-24T13:51:59Z"
      status: "False"
      type: Pending
    - lastTransitionTime: "2023-10-24T13:56:36Z"
      lastUpdateTime: "2023-10-24T13:56:36Z"
      status: "False"
      type: Running
    - lastTransitionTime: "2023-10-24T13:56:36Z"
      lastUpdateTime: "2023-10-24T13:56:36Z"
      status: "True"
      type: Complete
    config:
      kind: BuildConfig
      name: prox0001-registralibrorem
      namespace: pipelines-prod
    output: {}
    phase: Complete
    startTimestamp: "2023-10-24T13:51:56Z"
- apiVersion: build.openshift.io/v1
  kind: Build
  metadata:
    annotations:
      openshift.io/jenkins-blueocean-log-url: /http://jenkins-cicd.api-cloud.dirtrab.cl/blue/organizations/jenkins/pipelines-prod%2Fpipelines-prod-prox0001-registralibrorem/detail/pipelines-prod-prox0001-registralibrorem/27/
      openshift.io/jenkins-build-uri: http://jenkins-cicd.api-cloud.dirtrab.cl/job/pipelines-prod/job/pipelines-prod-prox0001-registralibrorem/27/
      openshift.io/jenkins-console-log-url: http://jenkins-cicd.api-cloud.dirtrab.cl/job/pipelines-prod/job/pipelines-prod-prox0001-registralibrorem/27/console
      openshift.io/jenkins-log-url: http://jenkins-cicd.api-cloud.dirtrab.cl/job/pipelines-prod/job/pipelines-prod-prox0001-registralibrorem/27/consoleText
      openshift.io/jenkins-status-json: '{"_links":{"self":{"href":"http://jenkins-cicd.api-cloud.dirtrab.cl/job/pipelines-prod/job/pipelines-prod-prox0001-registralibrorem/27/wfapi/describe"},"changesets":{"href":"/job/pipelines-prod/job/pipelines-prod-prox0001-registralibrorem/27/wfapi/changesets"}},"id":"27","name":"#27","status":"SUCCESS","startTimeMillis":1698155944409,"endTimeMillis":1698156223387,"durationMillis":278978,"queueDurationMillis":11,"pauseDurationMillis":0,"stages":[{"_links":{"self":{"href":"http://jenkins-cicd.api-cloud.dirtrab.cl/job/pipelines-prod/job/pipelines-prod-prox0001-registralibrorem/27/execution/node/6/wfapi/describe"}},"id":"6","name":"Clonando
        repo y Compilando","execNode":"","status":"SUCCESS","startTimeMillis":1698155952234,"durationMillis":201245,"pauseDurationMillis":0},{"_links":{"self":{"href":"http://jenkins-cicd.api-cloud.dirtrab.cl/job/pipelines-prod/job/pipelines-prod-prox0001-registralibrorem/27/execution/node/28/wfapi/describe"}},"id":"28","name":"Construyendo
        imagen","execNode":"","status":"SUCCESS","startTimeMillis":1698156155113,"durationMillis":56966,"pauseDurationMillis":0},{"_links":{"self":{"href":"http://jenkins-cicd.api-cloud.dirtrab.cl/job/pipelines-prod/job/pipelines-prod-prox0001-registralibrorem/27/execution/node/51/wfapi/describe"}},"id":"51","name":"Desplegando
        en Prod","execNode":"","status":"SUCCESS","startTimeMillis":1698156212479,"durationMillis":10841,"pauseDurationMillis":0}]}'
    creationTimestamp: "2023-10-24T13:59:04Z"
    generation: 1
    labels:
      app: cicd-pipeline
      buildconfig: prox0001-registralibrorem
      group: cicd
      migration.openshift.io/migrated-by-migmigration: 7765386f-b389-4f43-9a59-edf571957ed6
      migration.openshift.io/migrated-by-migplan: cc640fb7-e663-45df-b691-0008663d0ae9
      name: cicd-pipeline
      openshift.io/build-config.name: prox0001-registralibrorem
      openshift.io/build.start-policy: Serial
      template: cicd
      velero.io/backup-name: migration-15bf4-initial-6wqzl
      velero.io/restore-name: migration-15bf4-final-5jpwz
    name: prox0001-registralibrorem-8
    namespace: pipelines-prod
    ownerReferences:
    - apiVersion: build.openshift.io/v1
      controller: true
      kind: BuildConfig
      name: prox0001-registralibrorem
      uid: a939c29d-58b9-4fc7-b002-ca77daa6c6d1
    resourceVersion: "143088998"
    uid: afb9381f-cc49-4db5-b574-19a4bc3e6063
  spec:
    nodeSelector: {}
    output: {}
    postCommit: {}
    resources: {}
    serviceAccount: builder
    source:
      type: None
    strategy:
      jenkinsPipelineStrategy:
        env:
        - name: PROD_PROJECT
          value: api-fiscalizacion-prod
        - name: ENABLE_QUAY
          value: "false"
        jenkinsfile: |
          pipeline {
            agent {
              label 'maven'
            }
            stages {
              stage('Clonando repo y Compilando') {
                  steps {
                      git([url: 'https://dirtrab.visualstudio.com/Libro%20Remuneraciones%20Electronico/_git/PRX0001-RegistraLibroRemumeracion',
                      branch: 'feature/update_ws1_sii_20231016',
                      credentialsId: 'vsts'])
                  script {
                      def pom = readMavenPom file: 'pom.xml'
                      version = pom.version
                  }
                  sh "mvn -s configuration/settings.xml install -DskipTests=true"
                }
              }
              stage('Creando Image Builder') {
                when {
                  expression {
                    openshift.withCluster() {
                      openshift.withProject(env.PROD_PROJECT) {
                        return !openshift.selector("bc", "prox0001-registralibrore").exists();
                      }
                    }
                  }
                }
                steps {
                  script {
                    openshift.withCluster() {
                      openshift.withProject(env.PROD_PROJECT) {
                        openshift.newBuild("--name=prox0001-registralibrore", "--image-stream=fuse7-java-openshift:1.3", "--binary=true")
                      }
                    }
                  }
                }
              }
              stage('Construyendo imagen') {
                steps {
                  sh "rm -rf oc-build && mkdir -p oc-build/deployments"
                  sh "cp target/PRX0001-RegistraLibroRemumeracion-1.0.jar oc-build/deployments/PRX0001-RegistraLibroRemumeracion.jar"

                  script {
                    openshift.withCluster() {
                      openshift.withProject(env.PROD_PROJECT) {
                        openshift.selector("bc", "prox0001-registralibrore").startBuild("--from-dir=oc-build", "--wait=true")
                      }
                    }
                  }
                  sh "sleep 10"
                }
              }
              stage('Creando en Prod') {
                when {
                  expression {
                    openshift.withCluster() {
                      openshift.withProject(env.PROD_PROJECT) {
                        return !openshift.selector('dc', 'prox0001-registralibrore').exists()
                      }
                    }
                  }
                }
                steps {
                  script {
                    openshift.withCluster() {
                      openshift.withProject(env.PROD_PROJECT) {
                        def app = openshift.newApp("prox0001-registralibrore:latest")
                        app.narrow("svc").expose();
                        def dc = openshift.selector("dc", "prox0001-registralibrore")
                        while (dc.object().spec.replicas != dc.object().status.availableReplicas) {
                            sleep 10
                        }
                        openshift.set("triggers", "dc/prox0001-registralibrore", "--manual")
                      }
                      sh "sleep 40"
                    }
                  }
                }
              }
              stage('Desplegando en Prod') {
                steps {
                  script {
                    openshift.withCluster() {
                      openshift.withProject(env.PROD_PROJECT) {
                        openshift.selector("dc", "prox0001-registralibrore").rollout().latest();
                      }
                      sh "sleep 10"
                    }
                  }
                }
              }
            }
          }
      type: JenkinsPipeline
    triggeredBy:
    - message: Triggered by Jenkins job at http://jenkins-cicd.api-cloud.dirtrab.cl/job/pipelines-prod/job/pipelines-prod-prox0001-registralibrorem/
  status:
    completionTimestamp: "2023-10-24T14:03:43Z"
    conditions:
    - lastTransitionTime: "2023-10-24T13:59:04Z"
      lastUpdateTime: "2023-10-24T13:59:04Z"
      status: "False"
      type: New
    - lastTransitionTime: "2023-10-24T13:59:09Z"
      lastUpdateTime: "2023-10-24T13:59:09Z"
      status: "False"
      type: Pending
    - lastTransitionTime: "2023-10-24T14:03:43Z"
      lastUpdateTime: "2023-10-24T14:03:43Z"
      status: "False"
      type: Running
    - lastTransitionTime: "2023-10-24T14:03:43Z"
      lastUpdateTime: "2023-10-24T14:03:43Z"
      status: "True"
      type: Complete
    config:
      kind: BuildConfig
      name: prox0001-registralibrorem
      namespace: pipelines-prod
    output: {}
    phase: Complete
    startTimestamp: "2023-10-24T13:59:04Z"
- apiVersion: build.openshift.io/v1
  kind: Build
  metadata:
    annotations:
      openshift.io/jenkins-blueocean-log-url: /http://jenkins-cicd.api-cloud.dirtrab.cl/blue/organizations/jenkins/pipelines-prod%2Fpipelines-prod-prox0001-registralibrorem/detail/pipelines-prod-prox0001-registralibrorem/28/
      openshift.io/jenkins-build-uri: http://jenkins-cicd.api-cloud.dirtrab.cl/job/pipelines-prod/job/pipelines-prod-prox0001-registralibrorem/28/
      openshift.io/jenkins-console-log-url: http://jenkins-cicd.api-cloud.dirtrab.cl/job/pipelines-prod/job/pipelines-prod-prox0001-registralibrorem/28/console
      openshift.io/jenkins-log-url: http://jenkins-cicd.api-cloud.dirtrab.cl/job/pipelines-prod/job/pipelines-prod-prox0001-registralibrorem/28/consoleText
      openshift.io/jenkins-status-json: '{"_links":{"self":{"href":"http://jenkins-cicd.api-cloud.dirtrab.cl/job/pipelines-prod/job/pipelines-prod-prox0001-registralibrorem/28/wfapi/describe"}},"id":"28","name":"#28","status":"SUCCESS","startTimeMillis":1698161551624,"endTimeMillis":1698161828864,"durationMillis":277240,"queueDurationMillis":18,"pauseDurationMillis":0,"stages":[{"_links":{"self":{"href":"http://jenkins-cicd.api-cloud.dirtrab.cl/job/pipelines-prod/job/pipelines-prod-prox0001-registralibrorem/28/execution/node/6/wfapi/describe"}},"id":"6","name":"Clonando
        repo y Compilando","execNode":"","status":"SUCCESS","startTimeMillis":1698161558477,"durationMillis":203198,"pauseDurationMillis":0},{"_links":{"self":{"href":"http://jenkins-cicd.api-cloud.dirtrab.cl/job/pipelines-prod/job/pipelines-prod-prox0001-registralibrorem/28/execution/node/28/wfapi/describe"}},"id":"28","name":"Construyendo
        imagen","execNode":"","status":"SUCCESS","startTimeMillis":1698161763785,"durationMillis":53839,"pauseDurationMillis":0},{"_links":{"self":{"href":"http://jenkins-cicd.api-cloud.dirtrab.cl/job/pipelines-prod/job/pipelines-prod-prox0001-registralibrorem/28/execution/node/51/wfapi/describe"}},"id":"51","name":"Desplegando
        en Prod","execNode":"","status":"SUCCESS","startTimeMillis":1698161818035,"durationMillis":10756,"pauseDurationMillis":0}]}'
    creationTimestamp: "2023-10-24T15:32:31Z"
    generation: 1
    labels:
      app: cicd-pipeline
      buildconfig: prox0001-registralibrorem
      group: cicd
      migration.openshift.io/migrated-by-migmigration: 7765386f-b389-4f43-9a59-edf571957ed6
      migration.openshift.io/migrated-by-migplan: cc640fb7-e663-45df-b691-0008663d0ae9
      name: cicd-pipeline
      openshift.io/build-config.name: prox0001-registralibrorem
      openshift.io/build.start-policy: Serial
      template: cicd
      velero.io/backup-name: migration-15bf4-initial-6wqzl
      velero.io/restore-name: migration-15bf4-final-5jpwz
    name: prox0001-registralibrorem-9
    namespace: pipelines-prod
    ownerReferences:
    - apiVersion: build.openshift.io/v1
      controller: true
      kind: BuildConfig
      name: prox0001-registralibrorem
      uid: a939c29d-58b9-4fc7-b002-ca77daa6c6d1
    resourceVersion: "143143658"
    uid: 3775b507-47f5-4013-919b-64eae19be03c
  spec:
    nodeSelector: {}
    output: {}
    postCommit: {}
    resources: {}
    serviceAccount: builder
    source:
      type: None
    strategy:
      jenkinsPipelineStrategy:
        env:
        - name: PROD_PROJECT
          value: api-fiscalizacion-prod
        - name: ENABLE_QUAY
          value: "false"
        jenkinsfile: |
          pipeline {
            agent {
              label 'maven'
            }
            stages {
              stage('Clonando repo y Compilando') {
                  steps {
                      git([url: 'https://dirtrab.visualstudio.com/Libro%20Remuneraciones%20Electronico/_git/PRX0001-RegistraLibroRemumeracion',
                      branch: 'feature/prueba_logs',
                      credentialsId: 'vsts'])
                  script {
                      def pom = readMavenPom file: 'pom.xml'
                      version = pom.version
                  }
                  sh "mvn -s configuration/settings.xml install -DskipTests=true"
                }
              }
              stage('Creando Image Builder') {
                when {
                  expression {
                    openshift.withCluster() {
                      openshift.withProject(env.PROD_PROJECT) {
                        return !openshift.selector("bc", "prox0001-registralibrore").exists();
                      }
                    }
                  }
                }
                steps {
                  script {
                    openshift.withCluster() {
                      openshift.withProject(env.PROD_PROJECT) {
                        openshift.newBuild("--name=prox0001-registralibrore", "--image-stream=fuse7-java-openshift:1.3", "--binary=true")
                      }
                    }
                  }
                }
              }
              stage('Construyendo imagen') {
                steps {
                  sh "rm -rf oc-build && mkdir -p oc-build/deployments"
                  sh "cp target/PRX0001-RegistraLibroRemumeracion-1.0.jar oc-build/deployments/PRX0001-RegistraLibroRemumeracion.jar"

                  script {
                    openshift.withCluster() {
                      openshift.withProject(env.PROD_PROJECT) {
                        openshift.selector("bc", "prox0001-registralibrore").startBuild("--from-dir=oc-build", "--wait=true")
                      }
                    }
                  }
                  sh "sleep 10"
                }
              }
              stage('Creando en Prod') {
                when {
                  expression {
                    openshift.withCluster() {
                      openshift.withProject(env.PROD_PROJECT) {
                        return !openshift.selector('dc', 'prox0001-registralibrore').exists()
                      }
                    }
                  }
                }
                steps {
                  script {
                    openshift.withCluster() {
                      openshift.withProject(env.PROD_PROJECT) {
                        def app = openshift.newApp("prox0001-registralibrore:latest")
                        app.narrow("svc").expose();
                        def dc = openshift.selector("dc", "prox0001-registralibrore")
                        while (dc.object().spec.replicas != dc.object().status.availableReplicas) {
                            sleep 10
                        }
                        openshift.set("triggers", "dc/prox0001-registralibrore", "--manual")
                      }
                      sh "sleep 40"
                    }
                  }
                }
              }
              stage('Desplegando en Prod') {
                steps {
                  script {
                    openshift.withCluster() {
                      openshift.withProject(env.PROD_PROJECT) {
                        openshift.selector("dc", "prox0001-registralibrore").rollout().latest();
                      }
                      sh "sleep 10"
                    }
                  }
                }
              }
            }
          }
      type: JenkinsPipeline
    triggeredBy:
    - message: Triggered by Jenkins job at http://jenkins-cicd.api-cloud.dirtrab.cl/job/pipelines-prod/job/pipelines-prod-prox0001-registralibrorem/
  status:
    completionTimestamp: "2023-10-24T15:37:08Z"
    conditions:
    - lastTransitionTime: "2023-10-24T15:32:31Z"
      lastUpdateTime: "2023-10-24T15:32:31Z"
      status: "False"
      type: New
    - lastTransitionTime: "2023-10-24T15:32:34Z"
      lastUpdateTime: "2023-10-24T15:32:34Z"
      status: "False"
      type: Pending
    - lastTransitionTime: "2023-10-24T15:37:08Z"
      lastUpdateTime: "2023-10-24T15:37:08Z"
      status: "False"
      type: Running
    - lastTransitionTime: "2023-10-24T15:37:08Z"
      lastUpdateTime: "2023-10-24T15:37:08Z"
      status: "True"
      type: Complete
    config:
      kind: BuildConfig
      name: prox0001-registralibrorem
      namespace: pipelines-prod
    output: {}
    phase: Complete
    startTimestamp: "2023-10-24T15:32:31Z"
kind: List
metadata:
  resourceVersion: ""
  selfLink: ""
